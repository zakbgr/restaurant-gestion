# ============================================
# TRAEFIK STATIC CONFIGURATION
# Machine 2 - API Gateway
# ============================================

# API Settings
api:
  dashboard: true
  insecure: true  # Set to false in production

# Entry Points
entryPoints:
  web:
    address: ":80"
  websecure:
    address: ":443"

# Consul Provider for Service Discovery
providers:
  consulCatalog:
    prefix: traefik
    exposedByDefault: false
    endpoint:
      address: "192.168.1.100:8500"  # Machine1 Consul address
    refreshInterval: "10s"
    
  # File provider for dynamic configuration
  file:
    filename: "/etc/traefik/dynamic.yml"
    watch: true

# Logging
log:
  level: INFO
  filePath: "/var/log/traefik/traefik.log"
  format: json

accessLog:
  filePath: "/var/log/traefik/access.log"
  format: json
  bufferingSize: 100
  fields:
    defaultMode: keep
    names:
      ClientUsername: drop
    headers:
      defaultMode: keep
      names:
        User-Agent: keep
        Authorization: drop
        Content-Type: keep

# Metrics (optional but recommended)
metrics:
  prometheus:
    addEntryPointsLabels: true
    addServicesLabels: true
    buckets:
      - 0.1
      - 0.3
      - 1.0
      - 3.0
      - 5.0

# Global settings
global:
  checkNewVersion: false
  sendAnonymousUsage: false